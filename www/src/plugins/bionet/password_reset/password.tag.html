<reset-password>
    <content-container style="padding-top:100px;">
        <section-container>
            <div id="password-reset-content" class="{theme.style.color.background} {theme.style.color.text}">
                <reset-password-email-form/>
            </div>
            <div style="height:30px" />
            <div class="center red-text">{msg}</div>
            <br/>
        </section-container>
    </content-container>
    <script>
        const tag = this
        this.msg = ''

        app.observe('passwordReset', function(step) {

            this.msg = step.msg
            tag.update()

            switch (step.name) {
                case 'email':
                    if (!step.err) riot.mount('div#password-reset-content', 'reset-password-email-form')
                    break;
                case 'password':
                    if (!step.err) riot.mount('div#password-reset-content', 'reset-password-form')
                    break;
                case 'complete':
                    app.getThemeMethod().toast('Password has been reset!')
                        //route('/');
                    app.dispatch('error', 'Password reset!!!')

                    /*
                    app.dispatch('signupServer', {
                      name: 'password',
                      value: this.enterpassword1.value
                    })
                    */
                    break;
            }
        })

    </script>
</reset-password>

<reset-password-email-form>
    <form class="col s6 center" onsubmit={submitForm}>
        <div style="height:40px" />
        <h5>Reset Password</h5>
        <input type="submit" style="display:none" />
        <form-text-input-empty label="enter email" ref="enteremail" name="enteremail" value={enteremailInit}/>
        <std-button action={submitForm} label="submit" />
    </form>
    <script>
        this.enteremailInit = ''

        this.submitForm = function(e) {
            e.preventDefault()
            app.dispatch('passwordReset', {
                name: 'password',
                value: this.enteremail.refs.value
            })
        }

    </script>
</reset-password-email-form>

<reset-password-form>
    <form class="col s6 center" onsubmit={submitForm}>
        <div style="height:40px" />
        <h5>Reset Password</h5>
        <password-text-input-empty label="enter a password" ref="enterpassword1" name="enterpassword1" />
        <password-text-input-empty label="enter password again" ref="enterpassword2" name="enterpassword2" />
        <input type="submit" style="display:none" />
        <std-button action={submitForm} label="submit" />
    </form>

    <script>
        this.submitForm = function(e) {
            e.preventDefault()
            // check if passwords match before proceeding
            if (this.enterpassword1.refs.value !== this.enterpassword2.refs.value) {
                app.dispatch('passwordReset', {
                    name: 'password',
                    err: true,
                    msg: 'Passwords do not match.'
                })
                return
            }
            app.dispatch('passwordReset', {
                name: 'complete',
                value: this.enterpassword1.refs.value
            })
        }

    </script>
</reset-password-form>
