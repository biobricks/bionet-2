<reset-password>
  <content-container style="padding-top:100px;">
    <section-container>
      <div id="password-reset-content" class="{theme.style.color.background} {theme.style.color.text}">
        <reset-password-email-form/>
      </div>
      <div style="height:30px" />
      <div class="center red-text">{msg}</div><br/>
    </section-container>
  </content-container>
  <script>
    const tag = this
    self.msg = ''

    app.observe('passwordReset', function(step) {

      self.msg = step.msg
      tag.update()

      switch (step.name) {
        case 'email':
          if (!step.err) riot.mount('div#password-reset-content', 'reset-password-email-form')
          break;
        case 'password':
          if (!step.err) riot.mount('div#password-reset-content', 'reset-password-form')
          break;
        case 'complete':
          app.getThemeMethod().toast('Password has been reset!')
          //riot.route('/');
          app.dispatch('error','Password reset!!!')
          
          /*
          app.dispatch('signupServer', {
            name: 'password',
            value: self.enterpassword1.value
          })
          */
          break;
      }
    })

  </script>
</reset-password>

<reset-password-email-form>
  <form class="col s6 center">
    <div style="height:40px" />
    <h5>Reset Password</h5>
    <form-text-input-empty label="enter email" name="enteremail" value={enteremailInit}/>
    <std-button action={submitForm} label="submit" />
  </form>
  <script>
    self.enteremailInit = ''

    self.submitForm = function(e) {
      app.dispatch('passwordReset', {
        name: 'password',
        value: self.enteremail.value
      })
    }

  </script>
</reset-password-email-form>

<reset-password-form>
  <form class="col s6 center">
    <div style="height:40px" />
    <h5>Reset Password</h5>
    <password-text-input-empty label="enter a password" name="enterpassword1" />
    <password-text-input-empty label="enter password again" name="enterpassword2" />
    <std-button action={submitForm} label="submit" />
  </form>

  <script>
    self.submitForm = function(e) {
      // check if passwords match before proceeding
      if (self.enterpassword1.value !== self.enterpassword2.value) {
        app.dispatch('passwordReset', {
          name: 'password',
          err: true,
          msg: 'Passwords do not match.'
        })
        return
      }
      app.dispatch('passwordReset', {
        name: 'complete',
        value: self.enterpassword1.value
      })
    }

  </script>
</reset-password-form>
