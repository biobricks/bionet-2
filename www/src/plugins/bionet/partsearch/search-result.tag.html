<search-result>
  <content-container style="padding-top:100px;">
    <section-container>
      <list-container>
        <list-header primary-header={primaryHeader} secondary-header={secondaryHeader}/>
        <list-item no-reorder each={item in searchresult} item={item}/>
      </list-container>
      <!--
      <pagination items={pagination}/>
      -->
    </section-container>
  </content-container>

  <script>
    const tag = this
    // todo: store search query somewhere else
    const q = sudocms.getModel('bioClassQuery')
    self.primaryHeader = 'Search results for "' + q.q + '"'

    self.pagination = [{
      url: '1',
      label: '1',
      active: 'active blue darken-2'
    }, {
      url: '2',
      label: '2'
    }, {
      url: '3',
      label: '3'
    }, {
      url: '4',
      label: '4'
    }, {
      url: '5',
      label: '5'
    }]

    //self.searchresult = []
    self.searchresult = sudocms.getModel('searchCache') || []
    self.secondaryHeader = self.searchresult.length + ' items'
    
    /*
    sudocms.observe('searchCache', (result) => {
      self.secondaryHeader = result.length + ' items'
      self.searchresult = result
      tag.update()
    })
    
    // handle begin stream message
    sudocms.addRouteDestination('searchResult', 'start', function() {
      //console.log('searchResult start')
      self.searchresult = []
      //sudocms.getStream('searchCache').init(undefined)
    })

    // handle end stream message
    sudocms.addRouteDestination('searchResult', 'end', function() {
      //console.log('searchResult end')
      //self.secondaryHeader = self.searchresult.length + ' items'
      //sudocms.dispatch('searchCache', self.searchresult)
      //tag.update()
    })

    sudocms.addRouteDestination('searchResult', 'packet', function(streamItem) {
      //console.log('searchResult packet')
      //console.log('search result: receiving packet %s', JSON.stringify(streamItem))
      self.secondaryHeader = self.searchresult.length + ' items'
      self.searchresult.push(streamItem)
      tag.update()
    })
    */

    // handle list message
    sudocms.addRouteDestination('searchResult', 'list', function(list) {
      self.secondaryHeader = list.length + ' items'
      self.searchresult = list
      tag.update()
      sudocms.dispatch('searchCache', list)
    })
                                

    this.on('unmount', function() {
      self.searchresult = undefined
      sudocms.removeRouteDestination('searchResult', 'list')
    })

  </script>
</search-result>
