<login>
  <div id="login-slideout2" class="side-nav" style="width:300px;z-index:9999">
    <close-button action={closeLogin} color='white' />
    <img src="static/images/bionet_login.png" width="300px" />
    <form class="col" style="margin-top:30px;margin-left:15%">
      <div class="row">
        <div class="input-field" style="width:85%">
          <input id="username" type="text" value="" />
          <label for="username" class="active">Email</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field" style="width:85%">
          <input id="loginpassword" type="password" value="" />
          <label for="loginpassword" class="active">Password</label>
        </div>
      </div>
      <std-button action={submitLogin} label="login" class="center" style="width:85%;margin:0" />
      <a onclick={forgotPassword} class="blue-text darken-3" style="padding:0;margin-top:30px;height:14px;line-height:14px">forgot password?</a>
    </form>
  </div>
  <script>
    self.closeLogin = function() {
      $('#login-slideout').sideNav('hide');
    }
    self.submitLogin = function() {
      sudocms.dispatch('login', {
        username: self.username.value,
        password: self.loginpassword.value
      })
    }
    self.forgotPassword=function() {
    }

  </script>
</login>

<login-button>
  <li if={!loggedIn}><a id="login-slideout" data-activates="login-slideout2" class="right {theme.style.color.navButton}" style="margin:0">login</a></li>
  <li if={loggedIn}><a href="/#!/logout" id="login-slideout" class="right {theme.style.color.navButton}">logout</a></li>
  <script>
    const tag = this;
    self.loggedIn = sudocms.getLoginState()
    var observer = {}
    this.on('before-mount', function() {
      //console.log('login-button mount')
      observer = sudocms.addObserver(sudocms.$.loginState, function(loggedIn) {
        //console.log('loginState, login.js')
        self.loggedIn = loggedIn
        tag.update()
      })
    })
    this.on('unmount', function() {
      sudocms.removeObserver(sudocms.$.loginState, observer)
    })

  </script>
</login-button>
