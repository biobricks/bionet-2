<view-physical>

  <div class="container" style="margin-top:100px">
    <h5 id="createPhysicalHeader"></h5>
    <form name="createPhysicalForm" class="col s12">
      <form-textarea-input label="Notes" name="notes" value={formData.notes}/>

      <img src={self.imgPath} width="600" /> 
      </div>
    </form>
  </div>
  <script>

    var path = require('path');

    this.createLabel = function() {

      var labelOpts = {
        title: self.printNameDefault,
        bsl: 1
      }

      var opts = {
        title: "Create label",
        subtitle: undefined,
        subTag: "print", // the tag to mount
        label: self.labelFormData || labelOpts,
        cb: function(err, formData, imageData) {
          self.labelFormData = formData;
          self.labelImageData = imageData;
          $(self.printModal).closeModal();
          $(self.createLabelButton).html('edit label');
        }
      }
      var tags = riot.mount('#printModal', 'modal-content', opts)

      $(self.printModal).openModal({
        complete: function() { 
          tags[0].unmount(true)
        }
      })
    }

    this.scanItem = function() {
      var opts = {
        title: "Scan",
        subtitle: "Scan the item's barcode",
        subTag: "scan", // the tag to mount
        cb: function(err, id) {
          if(err) return app.ui.toast("Scan failed: " + err); // TODO handle error
          $(self.curBarcode).html('  ' + id + '  ');
          $(self.scanButton).html('rescan');
          $(self.scanModal).closeModal();
          tags[0].unmount(true)
        }
      }
      var tags = riot.mount('#scanModal', 'modal-content', opts)

      $(self.scanModal).openModal({
        complete: function() { 
          tags[0].unmount(true)
        }
      })
    }

    this.scanContainer = function() {
      var opts = {
        title: "Scan location",
        subtitle: "Scan the barcode of e.g. the box or freezer where you put this item",
        subTag: "scan",
        cb: function(err, id) {
          if(err) return app.ui.toast("Scan failed: " + err); // TODO handle error
          $(self.curContainerBarcode).html('  ' + id + '  ');
          $(self.containerScanButton).html('rescan container');

          $(self.scanModal).closeModal();
          tags[0].unmount(true)
        }
      }
      var tags = riot.mount('#scanModal', 'modal-content', opts)

      $(self.scanModal).openModal({
        complete: function() { 
          tags[0].unmount(true)
        }
      })
    }

    this.on('mount', function() {
      self.formData = this.opts
      self.imgPath = '/static/labels/'+path.basename(formData.labelImagePath)
      this.update()
    }.bind(this));

  </script>
</view-physical>

